<!-- Behavior for setting up an ace editor...

     TODO: Make a class to pass an object with all options into,
     or use one provided by ace (too many separate attributes)

-->

<script>
  var FirepadBehaviors = FirepadBehaviors || {};
  FirepadBehaviors.AceBehavior = {
    properties: {
      /**
       * Theme for the ace editor instance to be created, can currenty
       * be set to 'light' or 'dark'
       */
      theme: {
        type: String,
        value: "light",
        notify: true
      },

      /**
       * Mode that the editor will be set to...for example 'javascript'
       *  or 'css'. Currently only supports css, js, and html
       */
      mode: {
        type: String,
        value: "javascript",
        notify: true
      },

      /**
       * Determines whether text in the ace editor wraps
       */
      wrap: {
        type: Boolean,
        value: false,
        notify: true
      },

      /**
       * Determines whether the ace editor uses a worker
       */
      useworker: {
        type: Boolean,
        value: false,
        notify: true
      },
    },

    /**
     * Create an instance of the ace editor and set the theme
     * @param {String} Name of the container that will hold the editor
     * @return {Object} Instance of the ace editor created
     */

    _createEditor: function(containerName){
      //// Create ACE
      var editor = ace.edit(containerName);
      // set theme based on attrubute
      if (this.theme == "dark") editor.setTheme("ace/theme/monokai");
      else editor.setTheme("ace/theme/textmate");
      return editor;
    },

    /**
     * Edit an ace session to set wrap, worker, and mode (separate function)
     * @param {Object} The editor instance whose session is being manipulated
     * @return {Object} The ace editor session
     */

    _editSession: function(editor){
      var session = editor.getSession();
      // set wrap based on attribute
      session.setUseWrapMode(this.wrap);
      // set worker based on attribute
      session.setUseWorker(this.useworker);
      // set mode based on attribute
      this._setMode(session);
      return session;
    },

    /**
     * Set the mode of an ace editor session
     * @param {Object} The ace editor session
     */

    _setMode: function(session){
      var fullMode = "ace/mode/" + this.mode;
      session.setMode(fullMode);
    },

    /**
     * Observer function that changes wrap mode on change of the "nowrap" attribute
     */

    _wrapModeChanged: function(){
      var editor = ace.edit('firepad-container');
      var session = editor.getSession();
      session.setUseWrapMode(this.wrap);
    }
  };
</script>
